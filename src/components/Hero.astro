---
import GlobeScene from './Globe/GlobeScene.tsx';
---

<section id="hero-section" class="min-h-screen flex items-start pt-24 md:items-center md:pt-0 px-6 md:px-16 lg:px-24 overflow-hidden">
  <div class="max-w-7xl mx-auto w-full grid grid-cols-1 md:grid-cols-2 items-center gap-2 md:gap-8 relative">

    <!-- Text -->
    <div id="hero-text" class="flex flex-col items-center text-center md:items-start md:text-left order-1 hero-anim z-10">
      <p data-i18n="role" class="text-[#60a5fa] font-mono text-sm mb-4 animate-fade-in" style="animation-delay: 0.1s;">
        Full-Stack Developer
      </p>
      <h1 data-i18n="name" class="text-4xl md:text-7xl font-bold text-white tracking-tight mb-4 md:mb-6 animate-fade-in" style="animation-delay: 0.25s;">
        Nawfal<br />Hassani
      </h1>
      <p data-i18n="tagline" class="text-[#a1a1aa] text-base md:text-lg max-w-md mb-6 md:mb-8 leading-relaxed animate-fade-in" style="animation-delay: 0.4s;">
        Building digital experiences that blend design and engineering.
      </p>
      <a
        href="#contact"
        data-i18n="cta"
        class="inline-flex items-center gap-2 bg-[#60a5fa] hover:bg-[#93c5fd] text-[#0a0a0a] font-medium px-6 py-3 rounded-full transition-colors w-fit animate-fade-in text-sm md:text-base"
        style="animation-delay: 0.55s;"
      >
        Get in Touch
      </a>
    </div>

    <!-- Globe + Explore button -->
    <div id="globe-area" class="relative flex items-center justify-center order-2 hero-anim" style="transform-origin: center center;">
      <div class="w-full h-[180px] md:h-[500px] relative">
        <GlobeScene client:only="react" />
      </div>
      <button
        id="explore-btn"
        class="absolute -bottom-28 right-0 md:bottom-4 md:right-4 inline-flex items-center gap-2 text-white/80 hover:text-white border border-white/20 hover:border-white/40 px-4 py-2 md:px-5 md:py-2.5 rounded-full cursor-pointer text-xs md:text-sm hero-anim bg-white/10 backdrop-blur-xl shadow-lg shadow-black/20 hover:bg-white/15"
      >
        <span data-i18n="explore">Explore</span>
        <svg class="w-3.5 h-3.5 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
        </svg>
      </button>
    </div>

    <!-- Explore content — right side on desktop, below on mobile -->
    <div id="explore-content" class="absolute right-0 top-1/2 -translate-y-1/2 w-full md:w-[45%] flex items-center justify-center hero-anim opacity-0 pointer-events-none">
      <!-- Tu me diras quoi mettre ici -->
    </div>

  </div>
</section>

<!-- Back button — fixed, always on top -->
<button
  id="back-btn"
  class="fixed top-4 left-4 md:bottom-8 md:top-auto md:left-1/2 md:-translate-x-1/2 z-50 inline-flex items-center gap-2 text-[#a1a1aa] hover:text-white border border-white/10 hover:border-white/30 px-3 py-1.5 md:px-5 md:py-2.5 rounded-full text-xs md:text-sm backdrop-blur-md bg-[#0a0a0a]/80 cursor-pointer hero-anim opacity-0 pointer-events-none"
>
  <svg class="w-3.5 h-3.5 md:w-4 md:h-4 rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
  </svg>
  <span data-i18n="back">Back</span>
</button>

<style>
  .hero-anim {
    transition: transform 1.4s cubic-bezier(0.16, 1, 0.3, 1),
                opacity 1s cubic-bezier(0.16, 1, 0.3, 1);
  }
</style>

<script>
  function initExplore() {
    const heroText = document.getElementById('hero-text');
    const globeArea = document.getElementById('globe-area');
    const exploreBtn = document.getElementById('explore-btn');
    const exploreContent = document.getElementById('explore-content');
    const backBtn = document.getElementById('back-btn');

    if (!heroText || !globeArea || !exploreBtn || !exploreContent || !backBtn) return;

    let isExploring = false;
    const isMobile = () => window.innerWidth < 768;

    function goExplore() {
      if (isExploring) return;
      isExploring = true;

      const grid = globeArea.parentElement!;
      const gridWidth = grid.getBoundingClientRect().width;

      // Animate text: fade out
      heroText.style.opacity = '0';
      heroText.style.transform = isMobile() ? 'translateY(40px)' : 'translateX(-60px)';
      heroText.style.pointerEvents = 'none';

      // Animate globe: move + up + scale
      if (isMobile()) {
        globeArea.style.transform = 'translateY(-30px) scale(1.15)';
      } else {
        const shiftX = -(gridWidth / 2);
        globeArea.style.transform = `translateX(${shiftX}px) translateY(-60px) scale(1.1)`;
      }

      // Hide explore button
      exploreBtn.style.opacity = '0';
      exploreBtn.style.pointerEvents = 'none';

      // Show explore content
      setTimeout(() => {
        exploreContent.style.opacity = '1';
        exploreContent.style.pointerEvents = 'auto';
      }, 400);

      // Show back button
      backBtn.style.opacity = '1';
      backBtn.style.pointerEvents = 'auto';
    }

    function goBack() {
      if (!isExploring) return;
      isExploring = false;

      exploreContent.style.opacity = '0';
      exploreContent.style.pointerEvents = 'none';

      globeArea.style.transform = '';

      heroText.style.opacity = '1';
      heroText.style.transform = '';
      heroText.style.pointerEvents = '';

      exploreBtn.style.opacity = '1';
      exploreBtn.style.pointerEvents = '';

      backBtn.style.opacity = '0';
      backBtn.style.pointerEvents = 'none';
    }

    exploreBtn.addEventListener('click', goExplore);
    backBtn.addEventListener('click', goBack);
  }

  document.addEventListener('DOMContentLoaded', initExplore);
  document.addEventListener('astro:page-load', initExplore);
</script>
